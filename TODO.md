- refactor recursive logic so that second run of downgrade_dependency() is not needed

- better logging to show why selected dependencies were downgraded
